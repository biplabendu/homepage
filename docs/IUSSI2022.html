<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Demography data for IUSSI</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.12/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-121215066-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-121215066-1');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Biplabendu Das</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="research.html">
    <span class="fa fa-flask"></span>
     
    Research
  </a>
</li>
<li>
  <a href="camponotus_floridanus.html">
    <span class="fa fa-bug"></span>
     
    Camponotus_floridanus
  </a>
</li>
<li>
  <a href="https://www.academia.edu/attachments/81365810/download_file">
    <span class="fa fa-address-card"></span>
     
    CV
  </a>
</li>
<li>
  <a href="ecology.html">
    <span class="fa fa-leaf"></span>
     
    EcologyLab
  </a>
</li>
<li>
  <a href="IUSSI2022.html">
    <span class="fa fa-pie-chart"></span>
     
    IUSSI_Demography
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/another_ant_guy">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/biplabendu/">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
<li>
  <a href="https://www.facebook.com/biplabendu">
    <span class="fa fa-facebook"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Demography data for IUSSI</h1>
<h4 class="author">DEIJ Committee, IUSSI</h4>
<address class="author_afil">
In case of questions, please contact <a href="https://biplabendu.github.io/homepage/">Biplabendu Das</a><br><h4 class="date">Last updated on 26 July, 2022</h4>

</div>


<hr />
<blockquote>
<p>What is this document?</p>
</blockquote>
<p>The goal:</p>
<p>Perform a rapid exploratory analyses of the demography data obtained from the survey performed on the audience interested in or/and attending the upcoming IUSSI international conference in 2022, San Diego.</p>
<hr />
<div id="raw-data" class="section level2">
<h2>01 Raw data</h2>
<p>Let’s take a look at few rows and columns of the raw data.</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
time_of_entry
</th>
<th style="text-align:left;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:left;">
add_gender
</th>
<th style="text-align:left;">
sex_orientation
</th>
<th style="text-align:left;">
add_sex_orientation
</th>
<th style="text-align:left;">
residence_location
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
2022/02/11 11:48:02 AM EST
</td>
<td style="text-align:left;">
25-29 years old
</td>
<td style="text-align:left;">
Cisgender man
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Continental US
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
2022/02/11 6:05:24 PM EST
</td>
<td style="text-align:left;">
25-29 years old
</td>
<td style="text-align:left;">
Cisgender woman
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Bisexual
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Continental US
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
2022/02/11 8:10:38 PM EST
</td>
<td style="text-align:left;">
35-39 years old
</td>
<td style="text-align:left;">
Cisgender woman
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Heterosexual
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Continental US
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
2022/02/13 12:12:18 PM EST
</td>
<td style="text-align:left;">
21-24 years olf
</td>
<td style="text-align:left;">
Cisgender man
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Homosexual (gay/lesbian)
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Europe
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
research_location
</th>
<th style="text-align:left;">
ethnic_identity
</th>
<th style="text-align:left;">
add_ethnic_identity
</th>
<th style="text-align:left;">
religious_identity
</th>
<th style="text-align:left;">
add_religious_identity
</th>
<th style="text-align:left;">
disability_identity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Continental US
</td>
<td style="text-align:left;">
Southeast Asian;Brown
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
I am not religious
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
I have no disability/impairment
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Australasia
</td>
<td style="text-align:left;">
Hispanic;Latinx;Brown
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Prefer not to respond
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
Continental US
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Christianity
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
I have no disability/impairment
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
I am not religious
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
I have no disability/impairment
</td>
</tr>
</tbody>
</table>
<div id="what-does-each-column-contain" class="section level3">
<h3>What does each column contain?</h3>
<p><strong>Column name: Description</strong></p>
<ul>
<li>time_of_entry:</li>
<li>age:</li>
<li>and so on..</li>
</ul>
<hr />
</div>
</div>
<div id="format-data" class="section level2">
<h2>02 Format data</h2>
<blockquote>
<p>Get the data into a tidy format</p>
</blockquote>
<ul>
<li>remove columns that are not useful for a first assessment
<ul>
<li>time_of_entry</li>
<li>add_xxx (all columns that contain additional response not listed)</li>
</ul></li>
<li>format each column by
<ul>
<li>separating multiple choices into separate rows</li>
<li>factorizing the variables</li>
<li>checking for erronneous choices/inputs</li>
</ul></li>
</ul>
<pre class="r"><code>## Tidy and save data
dat &lt;- 
  
  raw.dat %&gt;% as_tibble() %&gt;% 
  
  
  ## remove columns that you do not want
  select(-time_of_entry) %&gt;% 
  select(-starts_with(&quot;add&quot;)) %&gt;% 
  
  ## add a unique ID for each person
  rownames_to_column(&quot;ID&quot;) %&gt;% 
  
  ## AGE
  mutate(age = str_split_fixed(age, &quot; &quot;, n=2)[,1]) %&gt;%
  mutate(age = ifelse(age %in% c(&quot;&quot;,&quot;Prefer&quot;), other.var, age)) %&gt;%
  mutate(age = as.factor(age)) %&gt;%
      # ## Plot: AGE
      # group_by(age) %&gt;%
      # summarise(num = n()) %&gt;% 
      # ##
      # ggplot(aes(x=age, y=num)) +
      #   geom_point() +
      #   coord_flip() +
      #   theme_Publication()

  
  ## GENDER
    # there are two entries that contains the following two responses for gender identity
    # c(&quot;Cisgender woman;Prefer not to respond&quot;, &quot;Transgender man;Cisgender woman&quot;)),
    # five entries that stated &quot;Prefer not to respond&quot;, and one which is NA.
    # Rename all to &quot;Other&quot;
  mutate(gender = ifelse(!gender %in% c(&quot;Cisgender man&quot;, &quot;Cisgender woman&quot;, &quot;Non-binary&quot;,
                       &quot;Transgender man&quot;, &quot;Transgender woman&quot;), other.var, gender)) %&gt;%
  mutate(gender = as.factor(gender)) %&gt;%
      # ## Plot: GENDER
      # group_by(gender) %&gt;%
      # summarise(num = n()) %&gt;%
      # na.omit() %&gt;%
      # ##
      # ggplot(aes(x=gender, y=num/sum(num)*100)) +
      #   geom_point() +
      #   coord_flip() +
      #   theme_Publication()

  
  ## sex_orientation
  mutate(sex_orientation = ifelse(sex_orientation %in% c(&quot;Additional identity not listed? (Please click next and share)&quot;,&quot;Prefer not to respond&quot;), other.var, sex_orientation)) %&gt;% 
  mutate(sex_orientation = as.factor(sex_orientation)) %&gt;% 
  
  
  ## residence_location
  mutate(residence_location = ifelse(residence_location %in% c(&quot;Central America;Other&quot;,
                                     &quot;Continental US;South Asia&quot;,
                                     &quot;Europe;Middle East&quot;,
                                     &quot;Europe;Southeast Asia&quot;,
                                     &quot;Other&quot;), other.var, residence_location)) %&gt;%
  mutate(residence_location = as.factor(residence_location)) %&gt;% 


  ## research location
  # filter(research_location %in% c(&quot;Central America;Continental US&quot;, &quot;Europe;South America&quot;)) %&gt;%
  separate_rows(research_location, sep = &quot;;&quot;) %&gt;% 
  mutate(research_location = as.factor(research_location)) %&gt;% 
  
  
  ## ethnic_identity
  separate_rows(ethnic_identity, sep = &quot;;&quot;) %&gt;% 
  mutate(ethnic_identity = ifelse(ethnic_identity %in% c(&quot;A race or ethnicity not listed&quot;,
                                                         &quot;Prefer not to respond&quot;), 
                                  other.var, ethnic_identity)) %&gt;% 
  mutate(ethnic_identity = as.factor(ethnic_identity)) %&gt;% 
  
  
  ## religious_identity
  mutate(religious_identity = ifelse(religious_identity %in% c(&quot;An additional affiliation not listed&quot;,
                                                               &quot;Prefer not to respond&quot;), 
                                     other.var, religious_identity)) %&gt;% 
  mutate(religious_identity = as.factor(religious_identity)) %&gt;% 
  
  
  ## disability_identity
  separate_rows(disability_identity, sep = &quot;;&quot;) %&gt;% 
  mutate(disability_identity = as.factor(disability_identity)) %&gt;% 
  

  ## written_english
  mutate(written_english = as.factor(written_english)) %&gt;% 
  
  
  ## spoken_english
  mutate(spoken_english = as.factor(spoken_english)) %&gt;% 
  
  
  ## children_responsibility
  mutate(children_responsibility = as.factor(children_responsibility)) %&gt;% 
  
  
  ## adult_responsibility
  mutate(adult_responsibility = ifelse(adult_responsibility %in% c(&quot;Prefer not to respond&quot;, &quot;Other&quot;),
                                       other.var, adult_responsibility)) %&gt;% 
  mutate(adult_responsibility = as.factor(adult_responsibility)) %&gt;% 
  
  
  ## funds_for_care_inhibit
  mutate(funds_for_care_inhibit = as.factor(funds_for_care_inhibit)) %&gt;% 
  
  
  ## firstgen
  mutate(firstgen = as.factor(firstgen)) %&gt;%  
  
  
  ## current position
  separate_rows(current_position, sep = &quot;;&quot;) %&gt;% 
  mutate(current_position = as.factor(current_position)) %&gt;% 
  
  
  ## which_attended_before
  separate_rows(which_attended_before, sep = &quot;;&quot;) %&gt;% 
  mutate(which_attended_before = as.factor(which_attended_before)) %&gt;% 

  
  ## role_attended_before
  separate_rows(role_attended_before, sep = &quot;;&quot;) %&gt;% 
  mutate(role_attended_before = as.factor(role_attended_before)) %&gt;% 

  
  ## current_institute_desc
  separate_rows(current_institute_desc, sep = &quot;;&quot;) %&gt;% 
  mutate(current_institute_desc = as.factor(current_institute_desc)) %&gt;% 
  
  
  ## barriers_what_degree
  mutate(barriers_what_degree = as.factor(barriers_what_degree)) %&gt;% 
  
  
  ## barriers_which
  separate_rows(barriers_which, sep = &quot;;&quot;) %&gt;% 
  mutate(barriers_which = as.factor(barriers_which))


# ## get a glimpse of the tidy data
# dat[10:13,1:7] %&gt;% 
#   kable() %&gt;% 
#   kable_styling(bootstrap_options = c(&quot;striped&quot;), full_width = F, position = &quot;center&quot;, latex_options = &quot;scaled_down&quot;)
# 
# dat[10:13,8:13] %&gt;% 
#   kable() %&gt;% 
#   kable_styling(bootstrap_options = c(&quot;striped&quot;), full_width = F, position = &quot;center&quot;, latex_options = &quot;scaled_down&quot;)</code></pre>
<hr />
</div>
<div id="visualize" class="section level2">
<h2>03 Visualize</h2>
<pre class="r"><code>## Use this code chunk to define paramaters, such as color palettes and such

## COLOR
# role attended before
roles.color &lt;- c(&quot;#005C53&quot;, &quot;#F2E744&quot;, &quot;#D9814E&quot;, &quot;#BF6854&quot;, &quot;#261B1A&quot;, &quot;grey60&quot;)</code></pre>
<div id="age-gender" class="section level3">
<h3>Age &amp; gender</h3>
<pre class="r"><code>## AGE + GENDER
dat %&gt;% 
  
  # remove the rows with no age/gender info
  filter(age != other.var) %&gt;% 
  filter(!is.na(gender)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  # tally the number of people in a given age group for a given gender
  distinct(ID, age, gender) %&gt;%
  group_by(age, gender) %&gt;% 
  summarize(num=n()) %&gt;% 
    
  ## Plot: AGE + GENDER
  ggplot(aes(x=age, y=num, fill=gender, group=gender)) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_Publication() +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/age_gender-1.png" width="672" /></p>
<hr />
</div>
<div id="residence-location-gender" class="section level3">
<h3>Residence location &amp; gender</h3>
<pre class="r"><code># Residence location &amp; gender
dat %&gt;%

  # filter(!residence_location %in% c(&quot;Other&quot;)) %&gt;% 
  filter(!is.na(residence_location)) %&gt;%
  filter(!is.na(gender)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  distinct(ID, residence_location, gender) %&gt;% 
  group_by(residence_location, gender) %&gt;%
  summarize(num = n()) %&gt;% 
  
  ggplot(aes(x=residence_location, y=num, fill=gender, group=gender)) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_Publication() +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/residence_location_gender-1.png" width="672" /></p>
<hr />
</div>
<div id="research-location-gender" class="section level3">
<h3>Research location &amp; gender</h3>
<pre class="r"><code>## Plot: research_location + gender
dat %&gt;% 
  
  filter(!is.na(research_location)) %&gt;%
  filter(!is.na(gender)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;%
  
  distinct(ID, research_location, gender) %&gt;% 
  group_by(research_location, gender) %&gt;%
  summarize(num = n()) %&gt;% 
  
  ggplot(aes(x=research_location, y=num, fill=gender, group=gender)) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_Publication() +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/research_location_gender-1.png" width="672" /></p>
<blockquote>
<p>A bunch of folks perform research in Central America, but there seems to be no representation from folks living in Central America. There is, of course, the possibility that folks residing in Central America did not take the survey.</p>
</blockquote>
<hr />
</div>
<div id="role-of-attendee-gender" class="section level3">
<h3>Role of attendee &amp; gender</h3>
<pre class="r"><code>dat %&gt;% 
  
  # remove the rows with no info
  filter(!is.na(role_attended_before)) %&gt;%
  filter(!is.na(gender)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  distinct(ID, role_attended_before, gender) %&gt;% 
  group_by(role_attended_before, gender) %&gt;%
  summarize(num = n()) %&gt;% 
    
  ## Plot: research_location + gender
  ggplot(aes(x=role_attended_before, y=num, fill=gender, group=gender)) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_Publication() +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/role_attended_before_gender-1.png" width="672" /></p>
<hr />
</div>
<div id="current-position-gender" class="section level3">
<h3>Current position &amp; gender</h3>
<pre class="r"><code>dat %&gt;% 
  
  filter(!is.na(current_position)) %&gt;%
  filter(!is.na(gender)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 

  distinct(ID, current_position, gender) %&gt;% 
  group_by(current_position, gender) %&gt;%
  summarize(num = n()) %&gt;% 
  
  ggplot(aes(x=current_position, y=log2(num+1), fill=gender, group=gender)) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_Publication() +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/current_position_gender-1.png" width="672" /></p>
<hr />
<hr />
</div>
<div id="role-of-attendee-residence-location" class="section level3">
<h3>Role of attendee &amp; residence location</h3>
<pre class="r"><code>dat %&gt;% 
  
  # remove the rows with no age/gender info
  filter(!is.na(role_attended_before)) %&gt;%
  filter(!is.na(residence_location)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  distinct(ID, role_attended_before, residence_location) %&gt;% 
  group_by(role_attended_before, residence_location) %&gt;%
  summarize(num = n()) %&gt;%
    
  ggplot(aes(x=residence_location, y=num, fill=role_attended_before, group=role_attended_before)) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    # scale_fill_Publication() +
    scale_fill_manual(values = roles.color) +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/role_attended_before_residence_location-1.png" width="672" /></p>
<hr />
</div>
<div id="role-of-attendee-current-position" class="section level3">
<h3>Role of attendee &amp; current position</h3>
<pre class="r"><code>dat %&gt;% 
  
  # remove the rows with no age/gender info
  filter(!is.na(role_attended_before)) %&gt;%
  filter(!is.na(current_position)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  distinct(ID, role_attended_before, current_position) %&gt;% 
  group_by(role_attended_before, current_position) %&gt;%
  summarize(num = n()) %&gt;% 
    
  ## Plot: research_location + gender
  ggplot(aes(x=current_position, y=num, fill=role_attended_before, group=role_attended_before)) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_manual(values = roles.color) +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/role_attended_before_current_position-1.png" width="672" /></p>
<pre class="r"><code># to do:
# normalize the number of roles undertaken by a person in past IUSSI
# number of past roles / number of past IUSSI attended</code></pre>
<p>The above plot might be misleading since the higher number of roles assumed by (activity of) late, tenured Profs might be due to the higher number of previous conferences attened by them. So, it might make sense to have a standardized metric that gives us a better understanding of the activity of each group in IUSSI.</p>
<blockquote>
<p>Activity = number of roles assumed (including attendee) / number of IUSSIs attended</p>
</blockquote>
<pre class="r"><code>id &lt;- character()
num_attended &lt;- numeric()  
for (i in 1:length(levels(as.factor(dat$ID)))) {
    
    id[i] &lt;- levels(as.factor(dat$ID))[i]
    
    num_attended[i] &lt;-
      dat %&gt;% 
      filter(ID == id[i]) %&gt;%
      # select(which_attended_before)
      mutate(which_attended_before=as.character(which_attended_before)) %&gt;% 
      pull(which_attended_before) %&gt;% 
      unique() %&gt;% 
      as.factor() %&gt;% 
      levels() %&gt;% length() %&gt;% 
      as.numeric()
}

dummy.dat &lt;- data.frame(ID=id, num_attended=num_attended)

## Add this information to the primary dataset

dat %&gt;% 
  
  # add the num_attended column to dat
  left_join(dummy.dat, by=&quot;ID&quot;) %&gt;% 
    # check to see if it worked
    # select(ID, which_attended_before, num_attended) %&gt;% head(20)
  
  # remove the rows with no info
  filter(!is.na(role_attended_before)) %&gt;%
  filter(!is.na(current_position)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  select(ID, current_position, role_attended_before, num_attended) %&gt;% 
    # head(20)
  
  distinct(ID, role_attended_before, current_position, num_attended) %&gt;% 
  
  group_by(ID, current_position, num_attended) %&gt;%
  summarize(num_roles = n()) %&gt;% 
  arrange(as.numeric(ID)) %&gt;% 
  
  # calculate activity
  mutate(activity = num_roles/num_attended) %&gt;% 
    
  ## Plot: research_location + gender
  ggplot(aes(x=current_position, y=activity)) +
    # geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    geom_boxplot(alpha=0.7, outlier.colour = &quot;darkred&quot;, fill=viridis::inferno(10)[4]) +
    labs(y=&quot;# roles/attendance&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_Publication() +
    # scale_fill_manual(values = roles.color) +
    guides(fill = guide_legend(nrow = 8)) +
    theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="IUSSI2022_files/figure-html/role_attended_before_current_position_v2-1.png" width="672" /></p>
<hr />
</div>
<div id="role-of-attendee-ethnic-identity" class="section level3">
<h3>Role of attendee &amp; ethnic identity</h3>
<pre class="r"><code>dat %&gt;% 
  
  # remove the rows with no age/gender info
  filter(!is.na(role_attended_before)) %&gt;%
  filter(!is.na(ethnic_identity)) %&gt;%
  # filter(gender != &quot;Other&quot;) %&gt;% 
  
  distinct(ID, role_attended_before, ethnic_identity) %&gt;% 
  group_by(role_attended_before, ethnic_identity) %&gt;%
  summarize(num = n()) %&gt;% 
    
  ## Plot: research_location + gender
  ggplot(aes(x=ethnic_identity, y=num, fill=role_attended_before, group=role_attended_before)) +
    geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;, size=2) +
    labs(y=&quot;number of people&quot;) +
    # geom_hline(yintercept = 5, col=&quot;grey60&quot;, alpha=0.7, size=1) +
    coord_flip() +
    theme_Publication() +
    scale_colour_Publication() +
    scale_fill_manual(values = roles.color) +
    guides(fill = guide_legend(nrow = 3))</code></pre>
<p><img src="IUSSI2022_files/figure-html/role_attended_before_ethnic_identity-1.png" width="672" /></p>
<hr />
<hr />
</div>
</div>
<div id="overunder-represented-folks" class="section level2">
<h2>05 Over/Under-represented folks</h2>
<blockquote>
<p>Check which groups are <em>over/under-represented</em> at IUSSI, and for which activities.</p>
</blockquote>
<pre class="r"><code>#  load the GeneOverlap package to perform pairwise Fisher&#39;s exact test
library(GeneOverlap)

# which variable do you need to use for the x-axis
names.x &lt;- c(&quot;gender&quot;, 
             # &quot;age&quot;, 
             &quot;residence_location&quot;, &quot;research_location&quot;,
             &quot;current_position&quot;, &quot;ethnic_identity&quot;)

# initialize a list to hold all the possible groups that we want to plot
# on the x-axis
list.x &lt;- list()
for (j in 1:length(names.x)) {
  
  # what are the different groups in the filtering column
  groups.x &lt;- dat %&gt;% 
  pull(names.x[j]) %&gt;% 
  as.factor() %&gt;% 
  levels()
  # what is the name of the filtering column
  var &lt;- names.x[[j]]
  
  
  list.sub &lt;- list()
  for (i in 1:length(groups.x)) {
    list.sub[[i]] &lt;-
      dat %&gt;% filter(.data[[var]] %in% groups.x[[i]] ) %&gt;% pull(ID) %&gt;% unique()
    names(list.sub)[i] &lt;- groups.x[[i]] %&gt;% as.character()
  }
  
  # Save the results for the filtering column and name the different lists
  list.x[[j]] &lt;- list.sub
  
}

## DO THE SAME FOR THE Y-AXIS

names.y &lt;- c(&quot;role_attended_before&quot;)
list.y &lt;- list()

groups.y &lt;- dat %&gt;% 
  pull(names.y) %&gt;% 
  as.factor() %&gt;% 
  levels()
var &lt;- names.y

list.sub &lt;- list()
  for (i in 1:length(groups.y)) {
    list.sub[[i]] &lt;-
      dat %&gt;% filter(.data[[var]] %in% groups.y[[i]] ) %&gt;% pull(ID) %&gt;% unique()
    names(list.sub)[i] &lt;- groups.y[[i]] %&gt;% as.character()
  }
  
# Save the results for the filtering column and name the different lists
list.y &lt;- list.sub


## Run the pairwise Fisher&#39;s tests ##

## What is the total sample size
nFolks &lt;- dat %&gt;% pull(ID) %&gt;% unique() %&gt;% length()

## Remove the groups that contain less than 5 individuals
list.y &lt;- list.y[sapply(list.y, length)&gt;=5]

for (i in 1:length(list.x)) {

  # remove for x
  list.x[[i]] &lt;- list.x[[i]][sapply(list.x[[i]], length)&gt;=5]
    
  if (i==4) {
    names(list.x[[i]]) &lt;- names(list.x[[i]]) %&gt;% str_sub(end=9)
    gom &lt;- newGOM(list.y, list.x[[i]],
              nFolks)

  } 
  ## Let&#39;s perform the pairwise Fisher&#39;s exact test
gom &lt;- newGOM(list.x[[i]], list.y,
              nFolks)
png(paste0(path_to_repo,
           &quot;images/&quot;, folder.name,
           names.x[i],&quot;_v_&quot;,names.y,&quot;_gom.png&quot;), 
    width = 30, height = 20, units = &quot;cm&quot;, res = 300)
drawHeatmap(gom,
            # adj.p=T,
            cutoff=0.05,
            what=&quot;odds.ratio&quot;,
            # what=&quot;Jaccard&quot;,
            log.scale = T,
            grid.col=&quot;Oranges&quot;,
            note.col=&quot;black&quot;)
trash &lt;- dev.off()

}</code></pre>
<hr />
<p>The goal is to perform enrichment analyses (using hypergeometric analyses) to identify under (or over) represented groups (based on gender, ethnicity, etc) in different activities (roles) at IUSSI.</p>
<blockquote>
<p>We found several overrepresented groups for specific roles. The results are provided in the table/figure below.</p>
</blockquote>
<div id="results-in-a-table" class="section level3">
<h3>Results in a table</h3>
<pre class="r"><code>source(paste0(path_to_repo,&quot;functions/underrepresentation_analyses.R&quot;))

## Format the data
bg.dat &lt;- 
  dat %&gt;%
  select(ID, role_attended_before) %&gt;%
  group_by(ID) %&gt;%
  summarize(role_attended_before = str_c(role_attended_before, collapse = &quot;; &quot;)) %&gt;%
  ungroup()
  
results.list &lt;- list()
k &lt;- 1
# get a list of all gender IDs
for (i in 1:length(list.x)) {
  
  names.vars &lt;- names(list.x[[i]])
  
  for (j in 1:length(names.vars)) {
  results.list[[k]] &lt;- 
      list.x[[i]][[j]] %&gt;% 
        check_under(.,
                    bg.file = bg.dat,
                    what = paste0(names.x[[i]],&quot;: &quot;,names.vars[[j]]),
                    atleast = 3)
  k &lt;- k+1
  }
}

bind_rows(results.list, .id = &quot;column_label&quot;) %&gt;%
    dplyr::select(-column_label) %&gt;% 
    as_tibble() %&gt;% 
    filter(adj_pVal &lt; 0.05) %&gt;% 
    mutate(adj_pVal = round(adj_pVal,3)) %&gt;% 
    filter(over_under==&quot;over&quot;) %&gt;% 
  
    filter(what_desc != other.var) %&gt;% 
    filter(annot_term != &quot;no_annot&quot;) %&gt;% 
    
    select(annot_term:adj_pVal) %&gt;% 
    arrange(annot_term, adj_pVal) %&gt;% 
    
    DT::datatable()</code></pre>
<div id="htmlwidget-39d758d0c4c42c960af9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-39d758d0c4c42c960af9">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45"],["Administrative duties","Administrative duties","Administrative duties","Administrative duties","Administrative duties","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Attendee","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Invited speaker","Other","Other","Plenary speaker","Plenary speaker","Poster presenter","Poster presenter","Poster presenter","Poster presenter","Poster presenter","Poster presenter","Poster presenter","Poster presenter","Poster presenter"],["residence_location: Australasia","research_location: Australasia","current_position: Tenure tr","ethnic_identity: White","gender: Cisgender woman","gender: Cisgender woman","current_position: Tenure tr","ethnic_identity: additional_category","ethnic_identity: White","gender: additional_category","research_location: Middle East","residence_location: Australasia","residence_location: Middle East","research_location: Continental US","residence_location: Canada","research_location: Australasia","residence_location: Continental US","current_position: Post Doc","current_position: Non-tenur","current_position: Tenure tr","ethnic_identity: White","current_position: Tenure tr","research_location: Central America","residence_location: Canada","ethnic_identity: additional_category","residence_location: Continental US","research_location: Canada","gender: additional_category","research_location: Continental US","residence_location: Australasia","research_location: Sub-Saharan Africa","research_location: Australasia","ethnic_identity: South Asian","current_position: Post Doc","current_position: Tenure tr","ethnic_identity: White","gender: Cisgender man","current_position: Non-tenur","current_position: Tenure tr","ethnic_identity: White","current_position: Tenure tr","research_location: South America","research_location: Canada","residence_location: Canada","research_location: Sub-Saharan Africa"],["over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over","over"],[0,0,0,0.024,0.034,0,0,0,0,0.001,0.001,0.008,0.016,0.024,0.045,0.045,0.047,0.049,0,0,0,0.004,0.006,0.011,0.012,0.018,0.018,0.02,0.026,0.034,0.038,0.045,0,0.013,0,0.038,0,0,0,0.001,0.004,0.012,0.014,0.019,0.029]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>annot_term<\/th>\n      <th>what_desc<\/th>\n      <th>over_under<\/th>\n      <th>adj_pVal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":4},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<hr />
<blockquote>
<p>And, here are the results as a heatmap.</p>
</blockquote>
</div>
<div id="results-as-a-figure" class="section level3">
<h3>Results as a figure</h3>
<pre class="r"><code>results.dat &lt;- 
  bind_rows(results.list, .id = &quot;column_label&quot;) %&gt;%
    dplyr::select(-column_label) %&gt;% 
    as_tibble() %&gt;% 
    filter(adj_pVal &lt; 0.05) %&gt;% 
    mutate(adj_pVal = round(adj_pVal,3)) %&gt;% 
    filter(over_under==&quot;over&quot;) %&gt;% 
  
    filter(what_desc != other.var) %&gt;% 
    filter(annot_term != &quot;no_annot&quot;) %&gt;% 
    
    select(annot_term:adj_pVal) %&gt;% 
    arrange(annot_term, adj_pVal)
  

mat &lt;- 
  results.dat %&gt;% 
  select(-over_under) %&gt;% 
  pivot_wider(names_from = &quot;what_desc&quot;,
              values_from = &quot;adj_pVal&quot;,
              values_fn = list(adj_pVal = min)) %&gt;% 
  as.data.frame() %&gt;% 
  column_to_rownames(&quot;annot_term&quot;) %&gt;% 
  as.matrix()


# Plot the matrix
### note: 
### make sure the library &quot;plot.matrix&quot; is loaded
### see here for more params: https://cran.r-project.org/web/packages/plot.matrix/vignettes/plot.matrix.html
png(paste0(path_to_repo,
           &quot;images/&quot;, folder.name,
           &quot;enrichement_results.png&quot;), 
    width = 30, height = 20, units = &quot;cm&quot;, res = 300)
par(mar=c(10.1, 16.1, 4.1, 6.1))
  mat %&gt;% 
    t() %&gt;% 
    plot(., 
         # border=NA,
         col=viridis::viridis(3),
         spacing.key=1.5,
         fmt.key=&quot;%.3f&quot;,
         xlab = &quot;&quot;,
         ylab = &quot;&quot;,
         axis.col=list(side=1, las=2), axis.row = list(side=2, las=1))
trash &lt;- dev.off()</code></pre>
<div class="figure" style="text-align: center">
<img src="images/2022_demography_data/enrichement_results.png" alt="Results of the enrichment test; colors indicate p-values returned by the hypergeometric test. Lower p-values suggest possible over-representation." width="95%" />
<p class="caption">
Results of the enrichment test; colors indicate p-values returned by the hypergeometric test. Lower p-values suggest possible over-representation.
</p>
</div>
<hr />
</div>
</div>
<div id="supplementary" class="section level2">
<h2>Supplementary</h2>
<div id="reproducibility" class="section level3">
<h3>1. Reproducibility</h3>
<ul>
<li><p>All code used for this document is available on my <a href="https://github.com/biplabendu/homepage/blob/master/IUSSI2022.Rmd">Github</a>.</p></li>
<li><p>The function to perform enrichment analyses can be found <a href="https://github.com/biplabendu/homepage/blob/master/functions/underrepresentation_analyses.R">here</a></p></li>
</ul>
</div>
<div id="iussi-2014-2018" class="section level3">
<h3>2. IUSSI 2014 &amp; 2018</h3>
<p>A summary of the demography data for folks that attended IUSSI 2014 and 2018 can be found <a href="https://biplabendu.github.io/homepage/IUSSI.html">here</a>.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
